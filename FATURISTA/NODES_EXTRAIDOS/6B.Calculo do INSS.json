{
  "parameters": {
    "jsCode": "// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// NÃ“ 6B - CÃLCULO DO INSS (v6.5 - CORREÃ‡Ã•ES CRÃTICAS)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// VersÃ£o: 6.5\n// Data: 29/01/2026\n// Autor: Start Assessoria PrevidenciÃ¡ria\n//\n// CORREÃ‡Ã•ES v6.5:\n// âœ… MR usa valor ORIGINAL do cliente (nÃ£o forÃ§a salÃ¡rio mÃ­nimo)\n// âœ… SalÃ¡rio mÃ­nimo Ã© apenas PISO (Math.max(mr, minimo))\n// âœ… REMOVIDO fallback de estimativa de data (marca CRITICO se nÃ£o achar)\n// âœ… Sistema de TAGS com CRITICIDADE (OK, INFO, AVISO, CRITICO)\n// âœ… NENHUM erro para o fluxo - sempre passa pro 6D via merge\n// âœ… Campo pode_faturar explÃ­cito\n// âœ… Campo resumo_tags com contagem\n// âœ… ok = cÃ¡lculo confiÃ¡vel (nÃ£o tem CRITICO)\n//\n// MANTIDO das versÃµes anteriores:\n// - CalendÃ¡rios 2025 e 2026 COMPLETOS\n// - CÃ¡lculo INSS progressivo com truncamento\n// - 13Âº salÃ¡rio por avos\n// - ValidaÃ§Ã£o de continuidade de pagamentos\n// - Mapeamento de IDs Deal/Invoice corretos\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst inicio = Date.now();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// SISTEMA DE TAGS COM CRITICIDADE\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst NIVEIS_CRITICIDADE = {\n  OK: { ordem: 0, emoji: 'âœ…', descricao: 'Tudo certo, pode faturar' },\n  INFO: { ordem: 1, emoji: 'â„¹ï¸', descricao: 'Informativo, nÃ£o afeta cÃ¡lculo' },\n  AVISO: { ordem: 2, emoji: 'âš ï¸', descricao: 'AtenÃ§Ã£o, revisar depois' },\n  CRITICO: { ordem: 3, emoji: 'ğŸ”´', descricao: 'Erro de cÃ¡lculo provÃ¡vel, NÃƒO faturar' }\n};\n\nconst TAGS = {\n  // === SUCESSO (OK) - Pode faturar com confianÃ§a ===\n  'OK_CALCULO_COMPLETO': { codigo: 'S01', nivel: 'OK', mensagem: 'CÃ¡lculo completo e confiÃ¡vel' },\n  'OK_PROJECAO_CONFIAVEL': { codigo: 'S02', nivel: 'OK', mensagem: 'ProjeÃ§Ã£o com calendÃ¡rio oficial' },\n  'OK_QUITACAO': { codigo: 'S03', nivel: 'OK', mensagem: '120 dias completos - quitaÃ§Ã£o' },\n  'OK_CALENDARIO_OFICIAL': { codigo: 'S04', nivel: 'OK', mensagem: 'Data obtida do calendÃ¡rio oficial' },\n\n  // === INFO - Informativo, nÃ£o afeta cÃ¡lculo ===\n  'INFO_PRIMEIRA_PARCELA': { codigo: 'I01', nivel: 'INFO', mensagem: 'Primeira parcela do benefÃ­cio' },\n  'INFO_TEM_13O': { codigo: 'I02', nivel: 'INFO', mensagem: '13Âº salÃ¡rio detectado (Start nÃ£o cobra)' },\n  'INFO_PARCELAS_JUNTAS': { codigo: 'I03', nivel: 'INFO', mensagem: 'MÃºltiplas parcelas no mesmo dia' },\n  'INFO_MR_AJUSTADO_MINIMO': { codigo: 'I04', nivel: 'INFO', mensagem: 'MR ajustado para novo salÃ¡rio mÃ­nimo' },\n  'INFO_PROJECAO_GERADA': { codigo: 'I05', nivel: 'INFO', mensagem: 'Parcelas futuras projetadas' },\n\n  // === AVISO - Revisar depois, mas cÃ¡lculo ok ===\n  'AVISO_QUASE_COMPLETO': { codigo: 'A01', nivel: 'AVISO', mensagem: 'Faltam â‰¤15 dias para completar' },\n  'AVISO_VALOR_BAIXO': { codigo: 'A02', nivel: 'AVISO', mensagem: 'Parcela com valor baixo (<R$100)' },\n  'AVISO_PERIODO_CURTO': { codigo: 'A03', nivel: 'AVISO', mensagem: 'PerÃ­odo muito curto (â‰¤5 dias)' },\n  'AVISO_EXTRATO_ANTIGO': { codigo: 'A04', nivel: 'AVISO', mensagem: 'Extrato pode estar desatualizado' },\n\n  // === CRÃTICO - VAI DAR ERRO DE CONTA, NÃƒO FATURAR ===\n  'CRITICO_MR_VAZIO': { codigo: 'C01', nivel: 'CRITICO', mensagem: 'MR vazio - impossÃ­vel calcular desconto INSS', campo: 'mr' },\n  'CRITICO_MR_INVALIDO': { codigo: 'C02', nivel: 'CRITICO', mensagem: 'MR invÃ¡lido (zero ou negativo)', campo: 'mr' },\n  'CRITICO_NB_VAZIO': { codigo: 'C03', nivel: 'CRITICO', mensagem: 'NB vazio - impossÃ­vel buscar calendÃ¡rio', campo: 'nb' },\n  'CRITICO_DIB_VAZIO': { codigo: 'C04', nivel: 'CRITICO', mensagem: 'DIB vazia - nÃ£o sabe quando comeÃ§ou benefÃ­cio', campo: 'dib' },\n  'CRITICO_DCB_VAZIO': { codigo: 'C05', nivel: 'CRITICO', mensagem: 'DCB vazia - projeÃ§Ã£o impossÃ­vel', campo: 'dcb' },\n  'CRITICO_DATA_NAO_ENCONTRADA': { codigo: 'C06', nivel: 'CRITICO', mensagem: 'Data de pagamento nÃ£o encontrada no calendÃ¡rio', campo: 'data_pagamento' },\n  'CRITICO_PULO_MES': { codigo: 'C07', nivel: 'CRITICO', mensagem: 'Pulo de mÃªs detectado na projeÃ§Ã£o', campo: 'projecao' },\n  'CRITICO_CPF_DIVERGENTE': { codigo: 'C08', nivel: 'CRITICO', mensagem: 'CPF do PDF diferente do Deal', campo: 'cpf' },\n  'CRITICO_DIAS_EXCEDIDOS': { codigo: 'C09', nivel: 'CRITICO', mensagem: 'Mais de 120 dias calculados - erro', campo: 'dias' },\n  'CRITICO_CREDITOS_VAZIO': { codigo: 'C10', nivel: 'CRITICO', mensagem: 'Sem crÃ©ditos no extrato', campo: 'creditos' },\n  'CRITICO_ERRO_6A': { codigo: 'C11', nivel: 'CRITICO', mensagem: 'Erro recebido do nÃ³ 6A', campo: '6A' },\n  'CRITICO_CALENDARIO_INEXISTENTE': { codigo: 'C12', nivel: 'CRITICO', mensagem: 'CalendÃ¡rio do ano nÃ£o disponÃ­vel', campo: 'calendario' }\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// FUNÃ‡Ã•ES DE CRIAÃ‡ÃƒO DE TAGS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst criarTag = (tagId, detalhes = {}) => {\n  const tagDef = TAGS[tagId];\n  if (!tagDef) {\n    return {\n      tag: tagId,\n      codigo: 'X99',\n      nivel: 'AVISO',\n      emoji: 'â“',\n      mensagem: `Tag desconhecida: ${tagId}`,\n      detalhes\n    };\n  }\n  \n  const nivelInfo = NIVEIS_CRITICIDADE[tagDef.nivel];\n  return {\n    tag: tagId,\n    codigo: tagDef.codigo,\n    nivel: tagDef.nivel,\n    emoji: nivelInfo.emoji,\n    mensagem: tagDef.mensagem,\n    campo: tagDef.campo || null,\n    detalhes: Object.keys(detalhes).length > 0 ? detalhes : null\n  };\n};\n\nconst gerarResumoTags = (tags) => {\n  const contagem = { OK: 0, INFO: 0, AVISO: 0, CRITICO: 0 };\n  const criticos = [];\n  \n  for (const t of tags) {\n    if (contagem[t.nivel] !== undefined) {\n      contagem[t.nivel]++;\n    }\n    if (t.nivel === 'CRITICO') {\n      criticos.push(t);\n    }\n  }\n  \n  // Determinar maior criticidade\n  let maiorCriticidade = 'OK';\n  if (contagem.CRITICO > 0) maiorCriticidade = 'CRITICO';\n  else if (contagem.AVISO > 0) maiorCriticidade = 'AVISO';\n  else if (contagem.INFO > 0) maiorCriticidade = 'INFO';\n  \n  return {\n    total_ok: contagem.OK,\n    total_info: contagem.INFO,\n    total_aviso: contagem.AVISO,\n    total_critico: contagem.CRITICO,\n    maior_criticidade: maiorCriticidade,\n    lista_criticos: criticos,\n    pode_faturar: contagem.CRITICO === 0\n  };\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// MAPEAMENTO DE CAMPOS DO DEAL (IDs Bitrix)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CD = {\n  cpf: 'UF_CRM_5F7DD07B0ADB5',\n  rg: 'UF_CRM_5F7DD07B11C33',\n  nit: 'UF_CRM_1766282969',\n  nb: 'UF_CRM_1737470444334',\n  nome_filho: 'UF_CRM_1699462600794',\n  categoria: 'UF_CRM_5F7DD07B0295D',\n  dib: 'UF_CRM_1765928945',\n  dip: 'UF_CRM_1766439387',\n  dcb: 'UF_CRM_1748433331869',\n  dn_mamae: 'UF_CRM_1602615428011',\n  dn_filho: 'UF_CRM_5F7DD07B1997D',\n  dn_certidao: 'UF_CRM_1714741602233',\n  data_dnv: 'UF_CRM_1742827283535',\n  data_requerimento: 'UF_CRM_6094054C7C1C8',\n  data_concessao: 'UF_CRM_1602256897805',\n  mr_cliente: 'UF_CRM_1741726157749',\n  valor_total_beneficio: 'UF_CRM_1742841962002',\n  aliquota_mr: 'UF_CRM_1742841855608',\n  valor_inss: 'UF_CRM_1634158430224',\n  valor_cliente: 'UF_CRM_1634828809106',\n  valor_previsto: 'UF_CRM_1635261498013',\n  valor_recebido: 'UF_CRM_1633535814529',\n  parcela_numero: 'UF_CRM_1634158972573',\n  qtd_parcelas: 'UF_CRM_1625253358741',\n  banco: 'UF_CRM_1603216440272',\n  endereco_banco: 'UF_CRM_1603216499370',\n  agencia_banco: 'UF_CRM_1762558313',\n  justificativa_direito: 'UF_CRM_1765636941',\n  data_rodagem: 'UF_CRM_1764270308863',\n  rodagem_comentario: 'UF_CRM_1764270260617',\n  assessor: 'UF_CRM_5F7DD07AEC035',\n  ultimo_relacionador: 'UF_CRM_1688072257656',\n  ddd_cliente: 'UF_CRM_659C48C5F0594',\n  data_reclamacao: 'UF_CRM_1704738513559',\n  data_qualificacao: 'UF_CRM_65E74D984ED3C',\n  data_recuperacao: 'UF_CRM_1713804709729',\n  data_encerramento: 'UF_CRM_663007E42D75E',\n  data_reentrada: 'UF_CRM_1615653096667',\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// MAPEAMENTO DE CAMPOS DA INVOICE (IDs Bitrix)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CI = {\n  cpf: 'UF_CRM_652439CFE551C',\n  rg: 'UF_CRM_652439D00A9CF',\n  nit: 'UF_CRM_6947602572F0A',\n  nb: 'UF_CRM_6790DAD756E3C',\n  \n  categoria: 'UF_CRM_652439D03479D',\n  dib: 'UF_CRM_69442F085B2CD',\n  dip: 'UF_CRM_683860072DEB8',\n  dcb: 'UF_CRM_6838600845561',\n  dn_mamae: 'UF_CRM_652439D0138A5',\n  dn_filho: 'UF_CRM_652439D021438',\n  dn_certidao: 'UF_CRM_66351141F40C7',\n  data_dnv: 'UF_CRM_67E17F1C70EAF',\n  data_requerimento: 'UF_CRM_652439D3530AB',\n  data_concessao: 'UF_CRM_652439D157BA8',\n  mr_cliente: 'UF_CRM_67D19072D84A8',\n  valor_diario: 'UF_CRM_69442F466791E',\n  valor_liquido_mensal: 'UF_CRM_69442F4D0909D',\n  valor_total_beneficio: 'UF_CRM_69442F535C91B',\n  valor_restante_inss: 'UF_CRM_69442F3A581C2',\n  aliquota_mr: 'UF_CRM_67E1B184633ED',\n  especie_beneficio: 'UF_CRM_69442F6570BDB',\n  valor_total_start: 'UF_CRM_69442F217FB9D',\n  saldo_restante_start: 'UF_CRM_69442F27CCFB3',\n  aliquota_start: 'UF_CRM_69442F596A782',\n  regra_aplicada: 'UF_CRM_69442F5F762AD',\n  valor_inss: 'UF_CRM_652439D8D6B8E',\n  valor_cliente: 'UF_CRM_652439D915311',\n  valor_previsto: 'UF_CRM_652439D9202B3',\n  parcela_numero: 'UF_CRM_652439D8E9608',\n  parcela_formato: 'UF_CRM_652439D8CDB53',\n  qtd_parcelas: 'UF_CRM_67E1AD2860054',\n  competencia: 'UF_CRM_691B6450B46E3',\n  competencia_final: 'UF_CRM_69442F0E9A95A',\n  periodo: 'UF_CRM_691B64560A17F',\n  ultima_comp_valida: 'UF_CRM_693D7DE5148DB',\n  credito_invalidado: 'UF_CRM_691B6467F11F2',\n  dias_ja_recebidos: 'UF_CRM_69442F2E321C4',\n  dias_restantes: 'UF_CRM_69442F3449D22',\n  data_inss: 'UF_CRM_652439D8B3207',\n  data_pagamento_extrato: 'UF_CRM_691B64616C2C9',\n  data_atualizacao_extrato: 'UF_CRM_691B646EC01BF',\n  banco: 'UF_CRM_652439D194A06',\n  endereco_banco: 'UF_CRM_652439D1A53FA',\n  agencia_banco: 'UF_CRM_691225FDDDBE4',\n  justificativa_direito: 'UF_CRM_693D7BBC3E5D3',\n  resultado_analise: 'UF_CRM_693D7CB58EBD2',\n  data_rodagem: 'UF_CRM_6929FDA3C8A79',\n  rodagem_comentario: 'UF_CRM_6929FD9E9A95D',\n  direito_ate: 'UF_CRM_679781AAB3B1D',\n  ultimo_relacionador: 'UF_CRM_65BD5488EC8E9',\n  ddd_cliente: 'UF_CRM_65BD5489DF3A2',\n  data_reclamacao: 'UF_CRM_65BD5489C89AD',\n  data_qualificacao: 'UF_CRM_65E777E2A0CED',\n  data_recuperacao: 'UF_CRM_662699414BCF0',\n  data_encerramento: 'UF_CRM_6631460FD3BB4',\n  data_reentrada: 'UF_CRM_678EADB02E460',\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CAMPOS EXTRAS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CAMPOS_EXTRAS = {\n  data_encerramento_sem_direito_deal: 'UF_CRM_663007E518A1E',\n  data_conversao_deal: 'UF_CRM_5F7DD07B204FD',\n  data_certidao_deal: 'UF_CRM_1674755625727',\n  data_consulta_deal: 'UF_CRM_1602256877083',\n  data_contato_deal: 'UF_CRM_1650915373840',\n  data_prox_contato_deal: 'UF_CRM_1650915411107',\n  data_sem_direito_deal: 'UF_CRM_1649701660322',\n  data_indeferimento_deal: 'UF_CRM_1620315580',\n  data_quebra_contrato_deal: 'UF_CRM_1737722079155',\n  relacionador_quebra_deal: 'UF_CRM_1737722166447',\n  relacionador_sem_direito_deal: 'UF_CRM_1737722233583',\n  recurso_deal: 'UF_CRM_1759219838803',\n  senha_deal: 'UF_CRM_1602257200479',\n  sugestao_senha_deal: 'UF_CRM_5FDA4FCE92DAA',\n  telefone_2_deal: 'UF_CRM_606C6C98B68A7',\n  telefone_3_deal: 'UF_CRM_606C6C9A00D10',\n  sine_deal: 'UF_CRM_1751375841241',\n  data_envio_recurso_deal: 'UF_CRM_1759220050331',\n  resultado_criacao_faturas_inv: 'UF_CRM_SMART_INVOICE_1767045330',\n  data_conversao_inv: 'UF_CRM_652439D0CF19F',\n  data_calculo_inv: 'UF_CRM_69442F14E544C',\n  data_certidao_inv: 'UF_CRM_652439DA75EFF',\n  data_consulta_inv: 'UF_CRM_652439D14CF3D',\n  data_acordo_inv: 'UF_CRM_652439DB85203',\n  data_contato_inv: 'UF_CRM_652439D9B26DF',\n  data_sem_direito_inv: 'UF_CRM_66ACE094C0195',\n  data_pagamento_inv: 'UF_CRM_652439D8BD582',\n  data_indeferimento_inv: 'UF_CRM_652439D3E866C',\n  data_recebimento_inv: 'UF_CRM_652439D1B26E2',\n  desconto_inv: 'UF_CRM_6838600A5C767',\n  data_quebra_contrato_inv: 'UF_CRM_6793A405B3FC1',\n  relacionador_quebra_inv: 'UF_CRM_6793A4065BECA',\n  relacionador_sem_direito_inv: 'UF_CRM_6793A40701BCB',\n  recurso_inv: 'UF_CRM_68DD552A351D0',\n  senha_inv: 'UF_CRM_652439D16254A',\n  sugestao_senha_inv: 'UF_CRM_652439D23E905',\n  telefone_2_inv: 'UF_CRM_652439D28D353',\n  telefone_3_inv: 'UF_CRM_652439D298A88',\n  sine_inv: 'UF_CRM_6883D4B47136F',\n  data_envio_recurso_inv: 'UF_CRM_68DD552F3DD02',\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CONSTANTES OFICIAIS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst SALARIO_MINIMO = {\n  2024: 1412.00,\n  2025: 1518.00,\n  2026: 1621.00\n};\n\nconst FAIXAS_INSS = {\n  2024: [\n    { limite: 1412.00, aliquota: 7.5 },\n    { limite: 2666.68, aliquota: 9.0 },\n    { limite: 4000.03, aliquota: 12.0 },\n    { limite: 7786.02, aliquota: 14.0 }\n  ],\n  2025: [\n    { limite: 1518.00, aliquota: 7.5 },\n    { limite: 2793.88, aliquota: 9.0 },\n    { limite: 4190.83, aliquota: 12.0 },\n    { limite: 8157.41, aliquota: 14.0 }\n  ],\n  2026: [\n    { limite: 1621.00, aliquota: 7.5 },\n    { limite: 2923.61, aliquota: 9.0 },\n    { limite: 4386.05, aliquota: 12.0 },\n    { limite: 8537.55, aliquota: 14.0 }\n  ]\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CALENDÃRIO INSS 2025 - ATÃ‰ 1 SALÃRIO MÃNIMO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CALENDARIO_ATE_1SM_2025 = {\n  '1': {\n    'dez/24': '2024-12-20', 'jan/25': '2025-01-27', 'fev/25': '2025-02-24', 'mar/25': '2025-03-25',\n    'abr/25': '2025-04-24', 'mai/25': '2025-05-26', 'jun/25': '2025-06-24', 'jul/25': '2025-07-25',\n    'ago/25': '2025-08-25', 'set/25': '2025-09-24', 'out/25': '2025-10-27', 'nov/25': '2025-11-24',\n    'dez/25': '2025-12-22'\n  },\n  '2': {\n    'dez/24': '2024-12-23', 'jan/25': '2025-01-28', 'fev/25': '2025-02-25', 'mar/25': '2025-03-26',\n    'abr/25': '2025-04-25', 'mai/25': '2025-05-27', 'jun/25': '2025-06-25', 'jul/25': '2025-07-28',\n    'ago/25': '2025-08-26', 'set/25': '2025-09-25', 'out/25': '2025-10-28', 'nov/25': '2025-11-25',\n    'dez/25': '2025-12-23'\n  },\n  '3': {\n    'dez/24': '2024-12-26', 'jan/25': '2025-01-29', 'fev/25': '2025-02-26', 'mar/25': '2025-03-27',\n    'abr/25': '2025-04-28', 'mai/25': '2025-05-28', 'jun/25': '2025-06-26', 'jul/25': '2025-07-29',\n    'ago/25': '2025-08-27', 'set/25': '2025-09-26', 'out/25': '2025-10-29', 'nov/25': '2025-11-26',\n    'dez/25': '2025-12-26'\n  },\n  '4': {\n    'dez/24': '2024-12-27', 'jan/25': '2025-01-30', 'fev/25': '2025-02-27', 'mar/25': '2025-03-28',\n    'abr/25': '2025-04-29', 'mai/25': '2025-05-29', 'jun/25': '2025-06-27', 'jul/25': '2025-07-30',\n    'ago/25': '2025-08-28', 'set/25': '2025-09-29', 'out/25': '2025-10-30', 'nov/25': '2025-11-27',\n    'dez/25': '2025-12-29'\n  },\n  '5': {\n    'dez/24': '2024-12-30', 'jan/25': '2025-01-31', 'fev/25': '2025-02-28', 'mar/25': '2025-03-31',\n    'abr/25': '2025-04-30', 'mai/25': '2025-05-30', 'jun/25': '2025-06-30', 'jul/25': '2025-07-31',\n    'ago/25': '2025-08-29', 'set/25': '2025-09-30', 'out/25': '2025-10-31', 'nov/25': '2025-11-28',\n    'dez/25': '2025-12-30'\n  },\n  '6': {\n    'dez/24': '2025-01-02', 'jan/25': '2025-02-03', 'fev/25': '2025-03-06', 'mar/25': '2025-04-01',\n    'abr/25': '2025-05-02', 'mai/25': '2025-06-02', 'jun/25': '2025-07-01', 'jul/25': '2025-08-01',\n    'ago/25': '2025-09-01', 'set/25': '2025-10-01', 'out/25': '2025-11-03', 'nov/25': '2025-12-01',\n    'dez/25': '2026-01-02'\n  },\n  '7': {\n    'dez/24': '2025-01-03', 'jan/25': '2025-02-04', 'fev/25': '2025-03-07', 'mar/25': '2025-04-02',\n    'abr/25': '2025-05-05', 'mai/25': '2025-06-03', 'jun/25': '2025-07-02', 'jul/25': '2025-08-04',\n    'ago/25': '2025-09-02', 'set/25': '2025-10-02', 'out/25': '2025-11-04', 'nov/25': '2025-12-02',\n    'dez/25': '2026-01-05'\n  },\n  '8': {\n    'dez/24': '2025-01-06', 'jan/25': '2025-02-05', 'fev/25': '2025-03-06', 'mar/25': '2025-04-03',\n    'abr/25': '2025-05-06', 'mai/25': '2025-06-04', 'jun/25': '2025-07-03', 'jul/25': '2025-08-05',\n    'ago/25': '2025-09-03', 'set/25': '2025-10-03', 'out/25': '2025-11-05', 'nov/25': '2025-12-03',\n    'dez/25': '2026-01-06'\n  },\n  '9': {\n    'dez/24': '2025-01-07', 'jan/25': '2025-02-06', 'fev/25': '2025-03-06', 'mar/25': '2025-04-04',\n    'abr/25': '2025-05-07', 'mai/25': '2025-06-05', 'jun/25': '2025-07-04', 'jul/25': '2025-08-06',\n    'ago/25': '2025-09-04', 'set/25': '2025-10-06', 'out/25': '2025-11-06', 'nov/25': '2025-12-04',\n    'dez/25': '2026-01-07'\n  },\n  '0': {\n    'dez/24': '2025-01-08', 'jan/25': '2025-02-07', 'fev/25': '2025-03-07', 'mar/25': '2025-04-07',\n    'abr/25': '2025-05-08', 'mai/25': '2025-06-06', 'jun/25': '2025-07-07', 'jul/25': '2025-08-07',\n    'ago/25': '2025-09-05', 'set/25': '2025-10-07', 'out/25': '2025-11-07', 'nov/25': '2025-12-05',\n    'dez/25': '2026-01-08'\n  }\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CALENDÃRIO INSS 2025 - ACIMA DE 1 SALÃRIO MÃNIMO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CALENDARIO_ACIMA_1SM_2025 = {\n  '1': {\n    'dez/24': '2025-01-02', 'jan/25': '2025-02-03', 'fev/25': '2025-03-06', 'mar/25': '2025-04-01',\n    'abr/25': '2025-05-02', 'mai/25': '2025-06-02', 'jun/25': '2025-07-01', 'jul/25': '2025-08-01',\n    'ago/25': '2025-09-01', 'set/25': '2025-10-01', 'out/25': '2025-11-03', 'nov/25': '2025-12-01',\n    'dez/25': '2026-01-02'\n  },\n  '6': {\n    'dez/24': '2025-01-02', 'jan/25': '2025-02-03', 'fev/25': '2025-03-06', 'mar/25': '2025-04-01',\n    'abr/25': '2025-05-02', 'mai/25': '2025-06-02', 'jun/25': '2025-07-01', 'jul/25': '2025-08-01',\n    'ago/25': '2025-09-01', 'set/25': '2025-10-01', 'out/25': '2025-11-03', 'nov/25': '2025-12-01',\n    'dez/25': '2026-01-02'\n  },\n  '2': {\n    'dez/24': '2025-01-03', 'jan/25': '2025-02-04', 'fev/25': '2025-03-07', 'mar/25': '2025-04-02',\n    'abr/25': '2025-05-05', 'mai/25': '2025-06-03', 'jun/25': '2025-07-02', 'jul/25': '2025-08-04',\n    'ago/25': '2025-09-02', 'set/25': '2025-10-02', 'out/25': '2025-11-04', 'nov/25': '2025-12-02',\n    'dez/25': '2026-01-05'\n  },\n  '7': {\n    'dez/24': '2025-01-03', 'jan/25': '2025-02-04', 'fev/25': '2025-03-07', 'mar/25': '2025-04-02',\n    'abr/25': '2025-05-05', 'mai/25': '2025-06-03', 'jun/25': '2025-07-02', 'jul/25': '2025-08-04',\n    'ago/25': '2025-09-02', 'set/25': '2025-10-02', 'out/25': '2025-11-04', 'nov/25': '2025-12-02',\n    'dez/25': '2026-01-05'\n  },\n  '3': {\n    'dez/24': '2025-01-06', 'jan/25': '2025-02-05', 'fev/25': '2025-03-06', 'mar/25': '2025-04-03',\n    'abr/25': '2025-05-06', 'mai/25': '2025-06-04', 'jun/25': '2025-07-03', 'jul/25': '2025-08-05',\n    'ago/25': '2025-09-03', 'set/25': '2025-10-03', 'out/25': '2025-11-05', 'nov/25': '2025-12-03',\n    'dez/25': '2026-01-06'\n  },\n  '8': {\n    'dez/24': '2025-01-06', 'jan/25': '2025-02-05', 'fev/25': '2025-03-06', 'mar/25': '2025-04-03',\n    'abr/25': '2025-05-06', 'mai/25': '2025-06-04', 'jun/25': '2025-07-03', 'jul/25': '2025-08-05',\n    'ago/25': '2025-09-03', 'set/25': '2025-10-03', 'out/25': '2025-11-05', 'nov/25': '2025-12-03',\n    'dez/25': '2026-01-06'\n  },\n  '4': {\n    'dez/24': '2025-01-07', 'jan/25': '2025-02-06', 'fev/25': '2025-03-06', 'mar/25': '2025-04-04',\n    'abr/25': '2025-05-07', 'mai/25': '2025-06-05', 'jun/25': '2025-07-04', 'jul/25': '2025-08-06',\n    'ago/25': '2025-09-04', 'set/25': '2025-10-06', 'out/25': '2025-11-06', 'nov/25': '2025-12-04',\n    'dez/25': '2026-01-07'\n  },\n  '9': {\n    'dez/24': '2025-01-07', 'jan/25': '2025-02-06', 'fev/25': '2025-03-06', 'mar/25': '2025-04-04',\n    'abr/25': '2025-05-07', 'mai/25': '2025-06-05', 'jun/25': '2025-07-04', 'jul/25': '2025-08-06',\n    'ago/25': '2025-09-04', 'set/25': '2025-10-06', 'out/25': '2025-11-06', 'nov/25': '2025-12-04',\n    'dez/25': '2026-01-07'\n  },\n  '5': {\n    'dez/24': '2025-01-08', 'jan/25': '2025-02-07', 'fev/25': '2025-03-07', 'mar/25': '2025-04-07',\n    'abr/25': '2025-05-08', 'mai/25': '2025-06-06', 'jun/25': '2025-07-07', 'jul/25': '2025-08-07',\n    'ago/25': '2025-09-05', 'set/25': '2025-10-07', 'out/25': '2025-11-07', 'nov/25': '2025-12-05',\n    'dez/25': '2026-01-08'\n  },\n  '0': {\n    'dez/24': '2025-01-08', 'jan/25': '2025-02-07', 'fev/25': '2025-03-07', 'mar/25': '2025-04-07',\n    'abr/25': '2025-05-08', 'mai/25': '2025-06-06', 'jun/25': '2025-07-07', 'jul/25': '2025-08-07',\n    'ago/25': '2025-09-05', 'set/25': '2025-10-07', 'out/25': '2025-11-07', 'nov/25': '2025-12-05',\n    'dez/25': '2026-01-08'\n  }\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CALENDÃRIO INSS 2026 - ATÃ‰ 1 SALÃRIO MÃNIMO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CALENDARIO_ATE_1SM_2026 = {\n  '1': {\n    'dez/25': '2025-12-22', 'jan/26': '2026-01-26', 'fev/26': '2026-02-23', 'mar/26': '2026-03-25',\n    'abr/26': '2026-04-24', 'mai/26': '2026-05-25', 'jun/26': '2026-06-24', 'jul/26': '2026-07-27',\n    'ago/26': '2026-08-25', 'set/26': '2026-09-24', 'out/26': '2026-10-26', 'nov/26': '2026-11-24',\n    'dez/26': '2026-12-22'\n  },\n  '2': {\n    'dez/25': '2025-12-23', 'jan/26': '2026-01-27', 'fev/26': '2026-02-24', 'mar/26': '2026-03-26',\n    'abr/26': '2026-04-27', 'mai/26': '2026-05-26', 'jun/26': '2026-06-25', 'jul/26': '2026-07-28',\n    'ago/26': '2026-08-26', 'set/26': '2026-09-25', 'out/26': '2026-10-27', 'nov/26': '2026-11-25',\n    'dez/26': '2026-12-23'\n  },\n  '3': {\n    'dez/25': '2025-12-26', 'jan/26': '2026-01-28', 'fev/26': '2026-02-25', 'mar/26': '2026-03-27',\n    'abr/26': '2026-04-28', 'mai/26': '2026-05-27', 'jun/26': '2026-06-26', 'jul/26': '2026-07-29',\n    'ago/26': '2026-08-27', 'set/26': '2026-09-28', 'out/26': '2026-10-28', 'nov/26': '2026-11-26',\n    'dez/26': '2026-12-28'\n  },\n  '4': {\n    'dez/25': '2025-12-29', 'jan/26': '2026-01-29', 'fev/26': '2026-02-26', 'mar/26': '2026-03-30',\n    'abr/26': '2026-04-29', 'mai/26': '2026-05-28', 'jun/26': '2026-06-29', 'jul/26': '2026-07-30',\n    'ago/26': '2026-08-28', 'set/26': '2026-09-29', 'out/26': '2026-10-29', 'nov/26': '2026-11-27',\n    'dez/26': '2026-12-29'\n  },\n  '5': {\n    'dez/25': '2025-12-30', 'jan/26': '2026-01-30', 'fev/26': '2026-02-27', 'mar/26': '2026-03-31',\n    'abr/26': '2026-04-30', 'mai/26': '2026-05-29', 'jun/26': '2026-06-30', 'jul/26': '2026-07-31',\n    'ago/26': '2026-08-31', 'set/26': '2026-09-30', 'out/26': '2026-10-30', 'nov/26': '2026-11-30',\n    'dez/26': '2026-12-30'\n  },\n  '6': {\n    'dez/25': '2026-01-02', 'jan/26': '2026-02-02', 'fev/26': '2026-03-02', 'mar/26': '2026-04-01',\n    'abr/26': '2026-05-04', 'mai/26': '2026-06-01', 'jun/26': '2026-07-01', 'jul/26': '2026-08-03',\n    'ago/26': '2026-09-01', 'set/26': '2026-10-01', 'out/26': '2026-11-03', 'nov/26': '2026-12-01',\n    'dez/26': '2027-01-04'\n  },\n  '7': {\n    'dez/25': '2026-01-05', 'jan/26': '2026-02-03', 'fev/26': '2026-03-03', 'mar/26': '2026-04-02',\n    'abr/26': '2026-05-05', 'mai/26': '2026-06-02', 'jun/26': '2026-07-02', 'jul/26': '2026-08-04',\n    'ago/26': '2026-09-02', 'set/26': '2026-10-02', 'out/26': '2026-11-04', 'nov/26': '2026-12-02',\n    'dez/26': '2027-01-05'\n  },\n  '8': {\n    'dez/25': '2026-01-06', 'jan/26': '2026-02-04', 'fev/26': '2026-03-04', 'mar/26': '2026-04-06',\n    'abr/26': '2026-05-06', 'mai/26': '2026-06-03', 'jun/26': '2026-07-03', 'jul/26': '2026-08-05',\n    'ago/26': '2026-09-03', 'set/26': '2026-10-05', 'out/26': '2026-11-05', 'nov/26': '2026-12-03',\n    'dez/26': '2027-01-06'\n  },\n  '9': {\n    'dez/25': '2026-01-07', 'jan/26': '2026-02-05', 'fev/26': '2026-03-05', 'mar/26': '2026-04-07',\n    'abr/26': '2026-05-07', 'mai/26': '2026-06-05', 'jun/26': '2026-07-06', 'jul/26': '2026-08-06',\n    'ago/26': '2026-09-04', 'set/26': '2026-10-06', 'out/26': '2026-11-06', 'nov/26': '2026-12-04',\n    'dez/26': '2027-01-07'\n  },\n  '0': {\n    'dez/25': '2026-01-08', 'jan/26': '2026-02-06', 'fev/26': '2026-03-06', 'mar/26': '2026-04-08',\n    'abr/26': '2026-05-08', 'mai/26': '2026-06-08', 'jun/26': '2026-07-07', 'jul/26': '2026-08-07',\n    'ago/26': '2026-09-08', 'set/26': '2026-10-07', 'out/26': '2026-11-09', 'nov/26': '2026-12-07',\n    'dez/26': '2027-01-08'\n  }\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CALENDÃRIO INSS 2026 - ACIMA DE 1 SALÃRIO MÃNIMO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst CALENDARIO_ACIMA_1SM_2026 = {\n  '1': {\n    'dez/25': '2026-01-02', 'jan/26': '2026-02-02', 'fev/26': '2026-03-02', 'mar/26': '2026-04-01',\n    'abr/26': '2026-05-04', 'mai/26': '2026-06-01', 'jun/26': '2026-07-01', 'jul/26': '2026-08-03',\n    'ago/26': '2026-09-01', 'set/26': '2026-10-01', 'out/26': '2026-11-03', 'nov/26': '2026-12-01',\n    'dez/26': '2027-01-04'\n  },\n  '6': {\n    'dez/25': '2026-01-02', 'jan/26': '2026-02-02', 'fev/26': '2026-03-02', 'mar/26': '2026-04-01',\n    'abr/26': '2026-05-04', 'mai/26': '2026-06-01', 'jun/26': '2026-07-01', 'jul/26': '2026-08-03',\n    'ago/26': '2026-09-01', 'set/26': '2026-10-01', 'out/26': '2026-11-03', 'nov/26': '2026-12-01',\n    'dez/26': '2027-01-04'\n  },\n  '2': {\n    'dez/25': '2026-01-05', 'jan/26': '2026-02-03', 'fev/26': '2026-03-03', 'mar/26': '2026-04-02',\n    'abr/26': '2026-05-05', 'mai/26': '2026-06-02', 'jun/26': '2026-07-02', 'jul/26': '2026-08-04',\n    'ago/26': '2026-09-02', 'set/26': '2026-10-02', 'out/26': '2026-11-04', 'nov/26': '2026-12-02',\n    'dez/26': '2027-01-05'\n  },\n  '7': {\n    'dez/25': '2026-01-05', 'jan/26': '2026-02-03', 'fev/26': '2026-03-03', 'mar/26': '2026-04-02',\n    'abr/26': '2026-05-05', 'mai/26': '2026-06-02', 'jun/26': '2026-07-02', 'jul/26': '2026-08-04',\n    'ago/26': '2026-09-02', 'set/26': '2026-10-02', 'out/26': '2026-11-04', 'nov/26': '2026-12-02',\n    'dez/26': '2027-01-05'\n  },\n  '3': {\n    'dez/25': '2026-01-06', 'jan/26': '2026-02-04', 'fev/26': '2026-03-04', 'mar/26': '2026-04-06',\n    'abr/26': '2026-05-06', 'mai/26': '2026-06-03', 'jun/26': '2026-07-03', 'jul/26': '2026-08-05',\n    'ago/26': '2026-09-03', 'set/26': '2026-10-05', 'out/26': '2026-11-05', 'nov/26': '2026-12-03',\n    'dez/26': '2027-01-06'\n  },\n  '8': {\n    'dez/25': '2026-01-06', 'jan/26': '2026-02-04', 'fev/26': '2026-03-04', 'mar/26': '2026-04-06',\n    'abr/26': '2026-05-06', 'mai/26': '2026-06-03', 'jun/26': '2026-07-03', 'jul/26': '2026-08-05',\n    'ago/26': '2026-09-03', 'set/26': '2026-10-05', 'out/26': '2026-11-05', 'nov/26': '2026-12-03',\n    'dez/26': '2027-01-06'\n  },\n  '4': {\n    'dez/25': '2026-01-07', 'jan/26': '2026-02-05', 'fev/26': '2026-03-05', 'mar/26': '2026-04-07',\n    'abr/26': '2026-05-07', 'mai/26': '2026-06-05', 'jun/26': '2026-07-06', 'jul/26': '2026-08-06',\n    'ago/26': '2026-09-04', 'set/26': '2026-10-06', 'out/26': '2026-11-06', 'nov/26': '2026-12-04',\n    'dez/26': '2027-01-07'\n  },\n  '9': {\n    'dez/25': '2026-01-07', 'jan/26': '2026-02-05', 'fev/26': '2026-03-05', 'mar/26': '2026-04-07',\n    'abr/26': '2026-05-07', 'mai/26': '2026-06-05', 'jun/26': '2026-07-06', 'jul/26': '2026-08-06',\n    'ago/26': '2026-09-04', 'set/26': '2026-10-06', 'out/26': '2026-11-06', 'nov/26': '2026-12-04',\n    'dez/26': '2027-01-07'\n  },\n  '5': {\n    'dez/25': '2026-01-08', 'jan/26': '2026-02-06', 'fev/26': '2026-03-06', 'mar/26': '2026-04-08',\n    'abr/26': '2026-05-08', 'mai/26': '2026-06-08', 'jun/26': '2026-07-07', 'jul/26': '2026-08-07',\n    'ago/26': '2026-09-08', 'set/26': '2026-10-07', 'out/26': '2026-11-09', 'nov/26': '2026-12-07',\n    'dez/26': '2027-01-08'\n  },\n  '0': {\n    'dez/25': '2026-01-08', 'jan/26': '2026-02-06', 'fev/26': '2026-03-06', 'mar/26': '2026-04-08',\n    'abr/26': '2026-05-08', 'mai/26': '2026-06-08', 'jun/26': '2026-07-07', 'jul/26': '2026-08-07',\n    'ago/26': '2026-09-08', 'set/26': '2026-10-07', 'out/26': '2026-11-09', 'nov/26': '2026-12-07',\n    'dez/26': '2027-01-08'\n  }\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// FUNÃ‡Ã•ES UTILITÃRIAS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst tr = (v) => Math.floor((v || 0) * 100) / 100;\n\nconst getFaixasINSS = (ano) => FAIXAS_INSS[ano] || FAIXAS_INSS[2025];\n\nconst getSalarioMinimo = (ano) => SALARIO_MINIMO[ano] || SALARIO_MINIMO[2025];\n\nconst extrairDigitoCalendario = (nb) => {\n  const numeros = String(nb).replace(/\\D/g, '');\n  return numeros.length >= 2 ? numeros[numeros.length - 2] : '1';\n};\n\nconst formatarChaveCalendario = (competencia) => {\n  const mesesAbrev = ['jan', 'fev', 'mar', 'abr', 'mai', 'jun', 'jul', 'ago', 'set', 'out', 'nov', 'dez'];\n  const partes = competencia.split('/');\n  if (partes.length !== 2) return null;\n  const mes = parseInt(partes[0]);\n  const ano = String(partes[1]).slice(-2);\n  if (mes < 1 || mes > 12) return null;\n  return `${mesesAbrev[mes - 1]}/${ano}`;\n};\n\nconst calcularDias = (dataInicio, dataFim) => {\n  if (!dataInicio || !dataFim) return 0;\n  const d1 = new Date(dataInicio);\n  const d2 = new Date(dataFim);\n  return Math.floor((d2 - d1) / (1000 * 60 * 60 * 24)) + 1;\n};\n\nconst adicionarDias = (dataISO, dias) => {\n  const d = new Date(dataISO);\n  d.setDate(d.getDate() + dias);\n  return d.toISOString().substring(0, 10);\n};\n\nconst ultimoDiaMes = (ano, mes) => new Date(ano, mes, 0).getDate();\n\nconst extrairMesAno = (dataISO) => {\n  if (!dataISO) return null;\n  return { mes: parseInt(dataISO.substring(5, 7)), ano: parseInt(dataISO.substring(0, 4)) };\n};\n\nconst dataParaCompetencia = (dataISO) => {\n  const info = extrairMesAno(dataISO);\n  if (!info) return null;\n  return `${String(info.mes).padStart(2, '0')}/${info.ano}`;\n};\n\nconst competenciaParaData = (competencia, dia = 1) => {\n  const partes = competencia.split('/');\n  if (partes.length !== 2) return null;\n  let mes = parseInt(partes[0]);\n  let ano = parseInt(partes[1]);\n  if (ano < 100) ano += 2000;\n  return `${ano}-${String(mes).padStart(2, '0')}-${String(dia).padStart(2, '0')}`;\n};\n\nconst formatarMoeda = (valor) => `R$ ${(valor || 0).toFixed(2).replace('.', ',')}`;\n\nconst formatarData = (dataISO) => {\n  if (!dataISO) return '-';\n  const [ano, mes, dia] = dataISO.split('-');\n  return `${dia}/${mes}/${ano}`;\n};\n\nconst formatMoneyBitrix = (valor) => {\n  if (!valor && valor !== 0) return null;\n  return `${tr(valor)}|BRL`;\n};\n\nconst formatDateBitrix = (dataISO) => {\n  if (!dataISO) return null;\n  return `${dataISO}T03:00:00+00:00`;\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CÃLCULO INSS PROGRESSIVO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst calcularDescontoINSS = (mr, ano = 2025) => {\n  const faixas = getFaixasINSS(ano);\n  let descontoTotal = 0;\n  let baseAnterior = 0;\n  const detalhes = [];\n\n  for (const faixa of faixas) {\n    if (mr <= baseAnterior) break;\n    const baseCalculo = tr(Math.min(mr, faixa.limite) - baseAnterior);\n    if (baseCalculo > 0) {\n      const descontoFaixa = tr(baseCalculo * faixa.aliquota / 100);\n      descontoTotal += descontoFaixa;\n      detalhes.push({\n        faixa: detalhes.length + 1,\n        limite: faixa.limite,\n        aliquota: faixa.aliquota,\n        base_calculo: baseCalculo,\n        desconto: descontoFaixa\n      });\n    }\n    baseAnterior = faixa.limite;\n  }\n\n  descontoTotal = tr(descontoTotal);\n  const aliquotaEfetiva = mr > 0 ? tr((descontoTotal / mr) * 100) : 0;\n\n  return { desconto: descontoTotal, aliquota_efetiva: aliquotaEfetiva, detalhes };\n};\n\nconst calcularValoresDerivados = (mr, descontoINSS) => {\n  const liquidoMensal = tr(mr - descontoINSS);\n  const valorDiarioLiquido = tr(liquidoMensal / 30);\n  const total120Dias = tr(valorDiarioLiquido * 120);\n  return {\n    liquido_mensal: liquidoMensal,\n    valor_diario_liquido: valorDiarioLiquido,\n    total_120_dias: total120Dias\n  };\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// SELETOR DE CALENDÃRIO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst getCalendario = (anoCompetencia, faixaMR) => {\n  if (faixaMR === 'ATE_1SM') {\n    if (anoCompetencia <= 2024) return CALENDARIO_ATE_1SM_2025;\n    if (anoCompetencia === 2025) return CALENDARIO_ATE_1SM_2025;\n    if (anoCompetencia >= 2026) return CALENDARIO_ATE_1SM_2026;\n  } else {\n    if (anoCompetencia <= 2024) return CALENDARIO_ACIMA_1SM_2025;\n    if (anoCompetencia === 2025) return CALENDARIO_ACIMA_1SM_2025;\n    if (anoCompetencia >= 2026) return CALENDARIO_ACIMA_1SM_2026;\n  }\n  return CALENDARIO_ATE_1SM_2025;\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// v6.5 - OBTER DATA DE PAGAMENTO (SEM FALLBACK DE ESTIMATIVA!)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// REGRA: Se nÃ£o encontrar no calendÃ¡rio oficial, retorna null e marca CRITICO\n// NÃƒO INVENTA DATA!\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst obterDataPagamentoPorMes = (nb, mesPagamento, anoPagamento, mr) => {\n  const digitoCalendario = extrairDigitoCalendario(nb);\n  const salarioMinimo = getSalarioMinimo(anoPagamento);\n  const faixaMR = mr <= salarioMinimo ? 'ATE_1SM' : 'ACIMA_1SM';\n\n  // Verificar se temos calendÃ¡rio para esse ano\n  if (anoPagamento > 2026) {\n    return {\n      data_pagamento: null,\n      origem: 'CALENDARIO_INEXISTENTE',\n      erro: true,\n      tag: 'CRITICO_CALENDARIO_INEXISTENTE',\n      mensagem: `CalendÃ¡rio ${anoPagamento} nÃ£o disponÃ­vel`,\n      digito_nb: digitoCalendario,\n      faixa_mr: faixaMR,\n      ano_solicitado: anoPagamento\n    };\n  }\n\n  const calendario = getCalendario(anoPagamento, faixaMR);\n  const datas = calendario[digitoCalendario];\n\n  if (!datas) {\n    return {\n      data_pagamento: null,\n      origem: 'ERRO_DIGITO',\n      erro: true,\n      tag: 'CRITICO_DATA_NAO_ENCONTRADA',\n      mensagem: `DÃ­gito ${digitoCalendario} nÃ£o encontrado no calendÃ¡rio`,\n      digito_nb: digitoCalendario,\n      faixa_mr: faixaMR\n    };\n  }\n\n  // Formato do mÃªs de pagamento desejado: YYYY-MM\n  const mesPagamentoFormatado = `${anoPagamento}-${String(mesPagamento).padStart(2, '0')}`;\n\n  // Buscar no calendÃ¡rio a data que CAI nesse mÃªs\n  for (const [chaveComp, dataPagamento] of Object.entries(datas)) {\n    if (dataPagamento && dataPagamento.startsWith(mesPagamentoFormatado)) {\n      return {\n        data_pagamento: dataPagamento,\n        origem: 'CALENDARIO_OFICIAL',\n        erro: false,\n        tag: 'OK_CALENDARIO_OFICIAL',\n        digito_nb: digitoCalendario,\n        faixa_mr: faixaMR,\n        ano_calendario: anoPagamento <= 2025 ? 2025 : 2026,\n        competencia_calendario: chaveComp\n      };\n    }\n  }\n\n  // Tentar no calendÃ¡rio do ano anterior (para pagamentos no inÃ­cio do ano)\n  const calendarioAnterior = getCalendario(anoPagamento - 1, faixaMR);\n  const datasAnterior = calendarioAnterior[digitoCalendario];\n\n  if (datasAnterior) {\n    for (const [chaveComp, dataPagamento] of Object.entries(datasAnterior)) {\n      if (dataPagamento && dataPagamento.startsWith(mesPagamentoFormatado)) {\n        return {\n          data_pagamento: dataPagamento,\n          origem: 'CALENDARIO_OFICIAL_ANO_ANTERIOR',\n          erro: false,\n          tag: 'OK_CALENDARIO_OFICIAL',\n          digito_nb: digitoCalendario,\n          faixa_mr: faixaMR,\n          ano_calendario: anoPagamento - 1 <= 2025 ? 2025 : 2026,\n          competencia_calendario: chaveComp\n        };\n      }\n    }\n  }\n\n  // v6.5: NÃƒO FAZ FALLBACK DE ESTIMATIVA!\n  // Retorna null e marca como erro crÃ­tico\n  return {\n    data_pagamento: null,\n    origem: 'NAO_ENCONTRADA',\n    erro: true,\n    tag: 'CRITICO_DATA_NAO_ENCONTRADA',\n    mensagem: `Data de pagamento nÃ£o encontrada para ${mesPagamentoFormatado}`,\n    digito_nb: digitoCalendario,\n    faixa_mr: faixaMR,\n    mes_solicitado: mesPagamentoFormatado,\n    requer_revisao: true\n  };\n};\n\n// FunÃ§Ã£o para crÃ©ditos do extrato (mantida para compatibilidade)\nconst obterDataPagamentoINSS = (nb, competencia, mr, anoRef = 2025) => {\n  const digitoCalendario = extrairDigitoCalendario(nb);\n  const chaveComp = formatarChaveCalendario(competencia);\n  \n  if (!chaveComp) {\n    return { \n      data_pagamento: null, \n      origem: 'ERRO_COMPETENCIA',\n      erro: true,\n      tag: 'CRITICO_DATA_NAO_ENCONTRADA'\n    };\n  }\n\n  const partes = competencia.split('/');\n  let anoComp = parseInt(partes[1]);\n  if (anoComp < 100) anoComp += 2000;\n\n  const salarioMinimo = getSalarioMinimo(anoComp);\n  const faixaMR = mr <= salarioMinimo ? 'ATE_1SM' : 'ACIMA_1SM';\n  const calendario = getCalendario(anoComp, faixaMR);\n  const datas = calendario[digitoCalendario];\n\n  if (!datas) {\n    return { \n      data_pagamento: null, \n      origem: 'ERRO_DIGITO',\n      erro: true,\n      tag: 'CRITICO_DATA_NAO_ENCONTRADA'\n    };\n  }\n\n  const dataPagamento = datas[chaveComp];\n\n  if (dataPagamento) {\n    return {\n      data_pagamento: dataPagamento,\n      origem: 'CALENDARIO_OFICIAL',\n      erro: false,\n      tag: 'OK_CALENDARIO_OFICIAL',\n      digito_nb: digitoCalendario,\n      faixa_mr: faixaMR,\n      ano_calendario: anoComp <= 2025 ? 2025 : 2026\n    };\n  }\n\n  // v6.5: NÃƒO FAZ FALLBACK!\n  return {\n    data_pagamento: null,\n    origem: 'NAO_ENCONTRADA',\n    erro: true,\n    tag: 'CRITICO_DATA_NAO_ENCONTRADA',\n    mensagem: `CompetÃªncia ${competencia} nÃ£o encontrada no calendÃ¡rio`,\n    digito_nb: digitoCalendario,\n    faixa_mr: faixaMR\n  };\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// SITUAÃ‡ÃƒO FINANCEIRA COMPLETA\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst calcularSituacaoFinanceira = (creditos, valorDiarioLiquido) => {\n  const dias_pagos = creditos.filter(c => c.pagamento?.status === 'PAGO').reduce((sum, c) => sum + (c.dias || 0), 0);\n  const dias_pendentes = creditos.filter(c => c.pagamento?.status === 'PENDENTE').reduce((sum, c) => sum + (c.dias || 0), 0);\n  const dias_cobertos = dias_pagos + dias_pendentes;\n  const dias_restantes = Math.max(0, 120 - dias_cobertos);\n\n  const valor_pago = tr(creditos.filter(c => c.pagamento?.status === 'PAGO').reduce((sum, c) => sum + (c.valores?.liquido || 0), 0));\n  const valor_pendente = tr(creditos.filter(c => c.pagamento?.status === 'PENDENTE').reduce((sum, c) => sum + (c.valores?.liquido || 0), 0));\n  const valor_a_receber = tr(dias_restantes * valorDiarioLiquido);\n  const valor_total_beneficio = tr(120 * valorDiarioLiquido);\n\n  const pct_pago = tr((dias_pagos / 120) * 100);\n  const pct_pendente = tr((dias_pendentes / 120) * 100);\n  const pct_coberto = tr((dias_cobertos / 120) * 100);\n  const pct_restante = tr((dias_restantes / 120) * 100);\n\n  const parcelas_pagas = creditos.filter(c => c.pagamento?.status === 'PAGO').length;\n  const parcelas_pendentes = creditos.filter(c => c.pagamento?.status === 'PENDENTE').length;\n\n  return {\n    dias: { pagos: dias_pagos, pendentes: dias_pendentes, cobertos: dias_cobertos, restantes: dias_restantes, total: 120 },\n    valores: {\n      pago: valor_pago, pago_formatado: formatarMoeda(valor_pago),\n      pendente: valor_pendente, pendente_formatado: formatarMoeda(valor_pendente),\n      a_receber: valor_a_receber, a_receber_formatado: formatarMoeda(valor_a_receber),\n      total_beneficio: valor_total_beneficio, total_beneficio_formatado: formatarMoeda(valor_total_beneficio)\n    },\n    percentuais: { pago: pct_pago, pendente: pct_pendente, coberto: pct_coberto, restante: pct_restante },\n    parcelas: { pagas: parcelas_pagas, pendentes: parcelas_pendentes, total_extrato: creditos.length },\n    beneficio_completo: dias_cobertos >= 120,\n    tem_pendente: dias_pendentes > 0,\n    tem_a_receber: dias_restantes > 0\n  };\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// v6.5 - PROJEÃ‡ÃƒO DE PARCELAS FUTURAS (CORRIGIDA - MR ORIGINAL)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CORREÃ‡Ã•ES v6.5:\n// - Usa MR ORIGINAL do cliente (nÃ£o forÃ§a salÃ¡rio mÃ­nimo)\n// - SalÃ¡rio mÃ­nimo Ã© apenas PISO (Math.max)\n// - NÃ£o faz fallback de estimativa (marca CRITICO)\n// - MÃªs completo = valor mensal cheio\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst projetarParcelasFuturas = ({ dib, dcb, nb, mr, creditos, dias_restantes, valorDiarioLiquido, ultimo_dia_coberto }, tagsArray) => {\n  // ValidaÃ§Ãµes iniciais\n  if (!dcb || dias_restantes <= 0) return [];\n  if (!creditos || creditos.length === 0) return [];\n\n  const parcelas = [];\n\n  // 1. Identificar o ÃšLTIMO MÃŠS DE PAGAMENTO no extrato\n  let ultimaDataPagamento = null;\n  for (const credito of creditos) {\n    const dataPag = credito.pagamento?.data || credito.pagamento?.previsao;\n    if (dataPag && (!ultimaDataPagamento || dataPag > ultimaDataPagamento)) {\n      ultimaDataPagamento = dataPag;\n    }\n  }\n\n  if (!ultimaDataPagamento) return [];\n\n  \n  // 2. CORREÃ‡ÃƒO v6.6: Partir do Ãºltimo dia coberto + 1 dia\n  // A competÃªncia Ã© baseada no MÃŠS onde cai o primeiro dia do prÃ³ximo perÃ­odo\n  let primeiroDiaPeriodo;\n  if (ultimo_dia_coberto) {\n    primeiroDiaPeriodo = adicionarDias(ultimo_dia_coberto, 1);\n  } else {\n    // Fallback: usar Ãºltimo perÃ­odo do extrato\n    const ultimoCredito = creditos[creditos.length - 1];\n    if (ultimoCredito?.periodo?.fim) {\n      primeiroDiaPeriodo = adicionarDias(ultimoCredito.periodo.fim, 1);\n    } else {\n      // Ãšltimo recurso: usar data de pagamento\n      primeiroDiaPeriodo = adicionarDias(ultimaDataPagamento, 1);\n    }\n  }\n\n  // 3. Extrair mÃªs/ano do PERÃODO para competÃªncia\n  const { mes: mesPrimeiroDia, ano: anoPrimeiroDia } = extrairMesAno(primeiroDiaPeriodo);\n  \n  // 4. COMPETÃŠNCIA = mÃªs do perÃ­odo (usado para identificar a fatura)\n  let mesCompetencia = mesPrimeiroDia;\n  let anoCompetencia = anoPrimeiroDia;\n  let competenciaAtual = `${String(mesCompetencia).padStart(2, '0')}/${anoCompetencia}`;\n  \n  // 5. Extrair mÃªs/ano do ÃšLTIMO PAGAMENTO para calcular prÃ³ximo mÃªs de pagamento\n  const { mes: mesUltimoPgto, ano: anoUltimoPgto } = extrairMesAno(ultimaDataPagamento);\n  \n  // 6. MÃŠS DE PAGAMENTO = mÃªs seguinte ao Ãºltimo pagamento (usado para buscar no calendÃ¡rio)\n  let mesPagamentoAtual = mesUltimoPgto + 1;\n  let anoPagamentoAtual = anoUltimoPgto;\n  if (mesPagamentoAtual > 12) {\n    mesPagamentoAtual = 1;\n    anoPagamentoAtual++;\n  }\n  \n  // 7. TRAVA: Garantir que mÃªs de pagamento seja POSTERIOR ao Ãºltimo pagamento\n  const ultimoPgtoMesAno = `${anoUltimoPgto}-${String(mesUltimoPgto).padStart(2, '0')}`;\n  const proximoPgtoMesAno = `${anoPagamentoAtual}-${String(mesPagamentoAtual).padStart(2, '0')}`;\n  if (proximoPgtoMesAno <= ultimoPgtoMesAno) {\n    mesPagamentoAtual++;\n    if (mesPagamentoAtual > 12) {\n      mesPagamentoAtual = 1;\n      anoPagamentoAtual++;\n    }\n  }\n\n  let diasProjetados = 0;\n  let parcelaNum = 1;\n  let temErroCritico = false;\n\n  // 8. Loop por meses de COMPETÃŠNCIA (perÃ­odo)\n  while (diasProjetados < dias_restantes) {\n    // PERÃODO usa mesCompetencia/anoCompetencia\n    const inicioPeriodo = parcelaNum === 1 ? primeiroDiaPeriodo :\n      `${anoCompetencia}-${String(mesCompetencia).padStart(2, '0')}-01`;\n    const fimMes = `${anoCompetencia}-${String(mesCompetencia).padStart(2, '0')}-${ultimoDiaMes(anoCompetencia, mesCompetencia)}`;\n    \n    const fimPeriodo = fimMes <= dcb ? fimMes : dcb;\n\n    if (inicioPeriodo > dcb) break;\n\n    // CORREÃ‡ÃƒO v6.6: INSS usa sempre 30 dias por mÃªs (mÃªs comercial)\n    // MÃªs completo = 30 dias, independente de ter 28, 30 ou 31 dias reais\n    const primeiroDiaDoMes = `${anoCompetencia}-${String(mesCompetencia).padStart(2, '0')}-01`;\n    const ultimoDiaDoMesReal = ultimoDiaMes(anoCompetencia, mesCompetencia);\n    const ultimoDiaDoMes = `${anoCompetencia}-${String(mesCompetencia).padStart(2, '0')}-${ultimoDiaDoMesReal}`;\n    \n    // Verificar se Ã© mÃªs completo (comeÃ§a dia 1 e termina no Ãºltimo dia OU depois do DCB)\n    const ehMesCompleto = (inicioPeriodo === primeiroDiaDoMes) && (fimPeriodo === ultimoDiaDoMes);\n\n    \n\n\n   // CONTAGEM = dias corridos REAIS (para determinar quando completam 120 dias)\n    // VALOR = mÃªs completo paga MR cheio, parcial usa divisor 30\n    const diasPeriodo = calcularDias(inicioPeriodo, fimPeriodo);\n    const diasEfetivos = Math.min(diasPeriodo, dias_restantes - diasProjetados);\n\n   if (diasEfetivos <= 0) break;\n\n    // v6.6: MR ORIGINAL do cliente (com piso do salÃ¡rio mÃ­nimo)\n    const anoDoPeriodo = parseInt(inicioPeriodo.substring(0, 4));\n    const salarioMinimoPeriodo = getSalarioMinimo(anoDoPeriodo);\n    const mrDoPeriodo = Math.max(mr, salarioMinimoPeriodo);\n    \n    // Se MR foi ajustado para o mÃ­nimo, registrar como INFO\n    if (mr < salarioMinimoPeriodo) {\n      tagsArray.push(criarTag('INFO_MR_AJUSTADO_MINIMO', {\n        mr_original: mr,\n        mr_ajustado: salarioMinimoPeriodo,\n        ano: anoDoPeriodo\n      }));\n    }\n\n    // v6.6: Buscar data de pagamento pela COMPETÃŠNCIA (nÃ£o pelo mÃªs de pagamento!)\n    const resultadoData = obterDataPagamentoINSS(nb, competenciaAtual, mrDoPeriodo);\n\n    // Se nÃ£o encontrou data, marca crÃ­tico mas CONTINUA processando\n    if (resultadoData.erro) {\n      tagsArray.push(criarTag(resultadoData.tag, {\n        competencia: competenciaAtual,\n        mes_pagamento: `${mesPagamentoAtual}/${anoPagamentoAtual}`,\n        motivo: resultadoData.mensagem\n      }));\n      temErroCritico = true;\n    }\n\n    // Calcular valores do perÃ­odo\n    const descontoINSSPeriodo = calcularDescontoINSS(mrDoPeriodo, anoDoPeriodo);\n    const liquidoMensalPeriodo = tr(mrDoPeriodo - descontoINSSPeriodo.desconto);\n    const valorDiarioPeriodo = tr(liquidoMensalPeriodo / 30);\n\n    // Valor da parcela: mÃªs completo = valor mensal cheio\n    let valorLiquidoParcela;\n    if (ehMesCompleto) {\n      valorLiquidoParcela = liquidoMensalPeriodo;\n    } else {\n      valorLiquidoParcela = tr(valorDiarioPeriodo * diasEfetivos);\n    }\n    \n\n    parcelas.push({\n      numero: parcelaNum,\n      competencia: competenciaAtual,\n      periodo_inicio: inicioPeriodo,\n      periodo_fim: fimPeriodo,\n      dias: diasEfetivos,\n      valor_liquido: valorLiquidoParcela,\n      valor_liquido_formatado: formatarMoeda(valorLiquidoParcela),\n      data_pagamento_prevista: resultadoData.data_pagamento, // Pode ser null se nÃ£o encontrou\n      data_pagamento_prevista_formatada: formatarData(resultadoData.data_pagamento),\n      mes_pagamento: `${String(mesPagamentoAtual).padStart(2, '0')}/${anoPagamentoAtual}`,\n      origem_data: resultadoData.origem,\n      data_erro: resultadoData.erro || false,\n      digito_nb: resultadoData.digito_nb,\n      faixa_mr: resultadoData.faixa_mr,\n      ano_calendario: resultadoData.ano_calendario,\n      mr_utilizado: mrDoPeriodo,\n      eh_mes_completo: ehMesCompleto,\n      projetado: true,\n      status: 'PROJETADO'\n    });\n\n    diasProjetados += diasEfetivos;\n    parcelaNum++;\n\n    // AvanÃ§ar para prÃ³ximo mÃªs (AMBOS: competÃªncia e pagamento)\n    mesCompetencia++;\n    if (mesCompetencia > 12) {\n      mesCompetencia = 1;\n      anoCompetencia++;\n    }\n    mesPagamentoAtual++;\n    if (mesPagamentoAtual > 12) {\n      mesPagamentoAtual = 1;\n      anoPagamentoAtual++;\n    }\n    competenciaAtual = `${String(mesCompetencia).padStart(2, '0')}/${anoCompetencia}`;\n\n    if (parcelaNum > 12) break;\n  }\n\n  return parcelas;\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// VALIDAÃ‡ÃƒO DE CONTINUIDADE DE PAGAMENTOS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst validarContinuidadePagamentos = (creditosProcessados, parcelasProjetadas) => {\n  const todosPagamentos = [\n    ...creditosProcessados.map(c => ({\n      competencia: c.competencia,\n      data_pagamento: c.pagamento?.data || c.pagamento?.previsao || c.calculo_inss?.data_pagamento_calendario,\n      tipo: 'EXTRATO'\n    })),\n    ...parcelasProjetadas.filter(p => p.data_pagamento_prevista).map(p => ({\n      competencia: p.competencia,\n      data_pagamento: p.data_pagamento_prevista,\n      tipo: 'PROJETADO'\n    }))\n  ];\n\n  const pagamentosValidos = todosPagamentos.filter(p => p.data_pagamento);\n\n  if (pagamentosValidos.length < 2) {\n    return { valido: true, mensagem: 'Poucos pagamentos para validar' };\n  }\n\n  pagamentosValidos.sort((a, b) => a.data_pagamento.localeCompare(b.data_pagamento));\n\n  const mesesPagamento = [...new Set(pagamentosValidos.map(p => p.data_pagamento.substring(0, 7)))].sort();\n\n  const erros = [];\n  for (let i = 1; i < mesesPagamento.length; i++) {\n    const [anoAnt, mesAnt] = mesesPagamento[i-1].split('-').map(Number);\n    const [anoAtual, mesAtual] = mesesPagamento[i].split('-').map(Number);\n    const diffMeses = (anoAtual - anoAnt) * 12 + (mesAtual - mesAnt);\n    if (diffMeses > 1) {\n      erros.push({\n        de: mesesPagamento[i-1],\n        para: mesesPagamento[i],\n        pulo: diffMeses - 1\n      });\n    }\n  }\n\n  if (erros.length > 0) {\n    return {\n      valido: false,\n      mensagem: `Pulo de mÃªs detectado: ${erros.map(e => `${e.de} â†’ ${e.para} (${e.pulo} mÃªs(es))`).join(', ')}`,\n      erros,\n      meses_pagamento: mesesPagamento\n    };\n  }\n\n  return {\n    valido: true,\n    mensagem: 'Continuidade de pagamentos validada - sem pulos',\n    meses_pagamento: mesesPagamento\n  };\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 13Âº SALÃRIO\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst calcular13oSalario = (mr, dib, dcb) => {\n  if (!dib || !dcb) return null;\n\n  const dibDate = new Date(dib);\n  const dcbDate = new Date(dcb);\n  let avos = 0;\n  let mesesContados = [];\n\n  let dataAtual = new Date(dibDate);\n  while (dataAtual <= dcbDate) {\n    const ano = dataAtual.getFullYear();\n    const mes = dataAtual.getMonth() + 1;\n    const primeiroDiaMes = new Date(ano, mes - 1, 1);\n    const ultimoDiaMes = new Date(ano, mes, 0);\n    const inicioNoMes = dataAtual > primeiroDiaMes ? dataAtual : primeiroDiaMes;\n    const fimNoMes = dcbDate < ultimoDiaMes ? dcbDate : ultimoDiaMes;\n    const diasNoMes = Math.floor((fimNoMes - inicioNoMes) / (1000 * 60 * 60 * 24)) + 1;\n\n    mesesContados.push({ mes: `${String(mes).padStart(2, '0')}/${ano}`, dias: diasNoMes, conta_avo: diasNoMes >= 15 });\n    if (diasNoMes >= 15) avos++;\n\n    dataAtual = new Date(ano, mes, 1);\n  }\n\n  const valor13o = tr((mr / 12) * avos);\n\n  return {\n    valor_13o: valor13o,\n    valor_13o_formatado: formatarMoeda(valor13o),\n    avos,\n    avos_texto: `${avos}/12`,\n    meses_detalhes: mesesContados,\n    formula: `(${formatarMoeda(mr)} / 12) Ã— ${avos} = ${formatarMoeda(valor13o)}`\n  };\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// FUNÃ‡ÃƒO DE RETORNO (NUNCA PARA O FLUXO!)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst criarRetorno = (resumo, dados, tags, campos_deal, campos_invoice_base, ctx6A) => {\n  const resumoTags = gerarResumoTags(tags);\n  \n  return [{\n    json: {\n      // Metadados\n      _no: '6B',\n      _versao: '6.5',\n      _timestamp: new Date().toISOString(),\n      _tempo_ms: Date.now() - inicio,\n      _processou: true, // SEMPRE true - o nÃ³ rodou\n      \n      // Status do cÃ¡lculo\n      ok: resumoTags.pode_faturar, // true se nÃ£o tem CRITICO\n      pode_faturar: resumoTags.pode_faturar,\n      \n      // Tags com criticidade\n      tags: tags,\n      resumo_tags: resumoTags,\n      \n      // Dados do cÃ¡lculo\n      resumo: resumo,\n      dados: dados,\n      \n      // Mapeamento de IDs\n      CAMPOS_DEAL_IDS: CD,\n      CAMPOS_INVOICE_IDS: CI,\n      CAMPOS_EXTRAS: CAMPOS_EXTRAS,\n      \n      // Campos para atualizar\n      campos_deal: campos_deal,\n      campos_invoice_base: campos_invoice_base,\n      \n      // Contexto do 6A\n      deal_id: ctx6A?.deal_id,\n      deal: ctx6A?.deal\n    }\n  }];\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// EXECUÃ‡ÃƒO PRINCIPAL\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst ctx6A = $json;\nconst campos_deal_6A = ctx6A.campos_deal || {};\nconst campos_invoice_6A = ctx6A.campos_invoice_base || {};\nconst tags = [];\n\n// Se 6A veio com erro, propaga mas NÃƒO PARA\nif (!ctx6A.ok) {\n  tags.push(criarTag('CRITICO_ERRO_6A', {\n    erro_original: ctx6A.erro?.tag || 'DESCONHECIDO',\n    mensagem: ctx6A.erro?.mensagem || 'Erro nÃ£o especificado do 6A'\n  }));\n  \n  // Propagar tags do 6A se existirem\n  if (Array.isArray(ctx6A.tags)) {\n    for (const t of ctx6A.tags) {\n      if (t && !tags.find(x => x.tag === t.tag)) tags.push(t);\n    }\n  }\n  \n  const resumoBase = {\n    nome: ctx6A.cliente?.nome || 'Desconhecido',\n    cpf: ctx6A.cliente?.cpf || '',\n    nb: ctx6A.beneficio?.nb || '',\n    deal_id: ctx6A.deal_id,\n    erro_6a: true\n  };\n  \n  return criarRetorno(resumoBase, ctx6A, tags, campos_deal_6A, campos_invoice_6A, ctx6A);\n}\n\n// Se nÃ£o Ã© extrato de crÃ©ditos, apenas repassa\nif (ctx6A.tipo_documento !== 'EXTRATO_CREDITOS') {\n  tags.push(criarTag('OK_CALCULO_COMPLETO', { tipo: ctx6A.tipo_documento }));\n  \n  return criarRetorno(\n    { tipo_documento: ctx6A.tipo_documento, mensagem: 'Documento nÃ£o requer cÃ¡lculos INSS' },\n    ctx6A,\n    tags,\n    campos_deal_6A,\n    campos_invoice_6A,\n    ctx6A\n  );\n}\n\n// Extrair dados do 6A\nconst { cliente, beneficio, creditos, cobertura } = ctx6A;\nconst mr = beneficio?.mr;\nconst nb = beneficio?.nb;\nconst dib = beneficio?.dib;\nconst dcb = beneficio?.dcb;\nconst ano = dib ? parseInt(dib.substring(0, 4)) : 2025;\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// VALIDAÃ‡Ã•ES CRÃTICAS (nÃ£o param o fluxo, sÃ³ marcam tags)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nif (!mr || mr === '' || mr === null || mr === undefined) {\n  tags.push(criarTag('CRITICO_MR_VAZIO', { valor_recebido: mr }));\n} else if (mr <= 0 || isNaN(mr)) {\n  tags.push(criarTag('CRITICO_MR_INVALIDO', { valor_recebido: mr }));\n}\n\nif (!nb || nb === '') {\n  tags.push(criarTag('CRITICO_NB_VAZIO'));\n}\n\nif (!dib || dib === '') {\n  tags.push(criarTag('CRITICO_DIB_VAZIO'));\n}\n\nif (!dcb || dcb === '') {\n  tags.push(criarTag('CRITICO_DCB_VAZIO'));\n}\n\nif (!creditos || creditos.length === 0) {\n  tags.push(criarTag('CRITICO_CREDITOS_VAZIO'));\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// CÃLCULOS (mesmo com erros crÃ­ticos, tenta calcular o que dÃ¡)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst mrValido = mr && mr > 0 && !isNaN(mr) ? mr : 0;\nconst descontoINSS = mrValido > 0 ? calcularDescontoINSS(mrValido, ano) : { desconto: 0, aliquota_efetiva: 0, detalhes: [] };\nconst valoresDerivados = calcularValoresDerivados(mrValido, descontoINSS.desconto);\nconst situacaoFinanceira = calcularSituacaoFinanceira(creditos || [], valoresDerivados.valor_diario_liquido);\n\n// Processar crÃ©ditos do extrato\nconst creditosProcessados = (creditos || []).map(credito => {\n  const resultado = obterDataPagamentoINSS(nb || '', credito.competencia, mrValido);\n  \n  // Se nÃ£o encontrou data, registrar (mas nÃ£o criar tag duplicada aqui)\n  return {\n    ...credito,\n    calculo_inss: {\n      data_pagamento_calendario: resultado.data_pagamento,\n      data_pagamento_calendario_formatada: formatarData(resultado.data_pagamento),\n      origem_data: resultado.origem,\n      data_erro: resultado.erro || false,\n      digito_nb: resultado.digito_nb,\n      faixa_mr: resultado.faixa_mr,\n      ano_calendario: resultado.ano_calendario\n    }\n  };\n});\n\n// Projetar parcelas futuras\nlet parcelasProjetadas = [];\nif (situacaoFinanceira.tem_a_receber && situacaoFinanceira.dias.restantes > 0 && mrValido > 0 && nb && dcb) {\n  parcelasProjetadas = projetarParcelasFuturas({\n    dib,\n    dcb,\n    nb,\n    mr: mrValido,\n    creditos: creditosProcessados,\n    dias_restantes: situacaoFinanceira.dias.restantes,\n    valorDiarioLiquido: valoresDerivados.valor_diario_liquido,\n    ultimo_dia_coberto: cobertura?.ultimo_dia_coberto\n  }, tags);\n  \n  if (parcelasProjetadas.length > 0) {\n    tags.push(criarTag('INFO_PROJECAO_GERADA', { quantidade: parcelasProjetadas.length }));\n  }\n}\n\n// Validar continuidade de pagamentos\nif (parcelasProjetadas.length > 0) {\n  const validacao = validarContinuidadePagamentos(creditosProcessados, parcelasProjetadas);\n  if (!validacao.valido) {\n    tags.push(criarTag('CRITICO_PULO_MES', {\n      mensagem: validacao.mensagem,\n      erros: validacao.erros,\n      meses: validacao.meses_pagamento\n    }));\n  }\n}\n\n// Verificar se dias excederam 120\nconst diasTotais = situacaoFinanceira.dias.cobertos + parcelasProjetadas.reduce((sum, p) => sum + p.dias, 0);\nif (diasTotais > 120) {\n  tags.push(criarTag('CRITICO_DIAS_EXCEDIDOS', { dias_calculados: diasTotais }));\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ALERTAS E INFOS (nÃ£o crÃ­ticos)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n// 13Âº salÃ¡rio\nlet calculo13o = null;\nconst isAVista = situacaoFinanceira.beneficio_completo && !situacaoFinanceira.tem_a_receber;\nif (isAVista && creditos && creditos.length > 0 && mrValido > 0) {\n  calculo13o = calcular13oSalario(mrValido, dib, dcb);\n  if (calculo13o && calculo13o.valor_13o > 0) {\n    tags.push(criarTag('INFO_TEM_13O', { valor: calculo13o.valor_13o }));\n  }\n}\n\n// Primeira parcela\nif (creditos && creditos.length === 1 && situacaoFinanceira.dias.cobertos < 40) {\n  tags.push(criarTag('INFO_PRIMEIRA_PARCELA'));\n}\n\n// QuitaÃ§Ã£o\nif (situacaoFinanceira.beneficio_completo && !situacaoFinanceira.tem_a_receber) {\n  tags.push(criarTag('OK_QUITACAO'));\n}\n\n// Quase completo\nif (situacaoFinanceira.dias.restantes > 0 && situacaoFinanceira.dias.restantes <= 15) {\n  tags.push(criarTag('AVISO_QUASE_COMPLETO', { dias_restantes: situacaoFinanceira.dias.restantes }));\n}\n\n// Valores baixos e perÃ­odos curtos\nif (creditos) {\n  creditos.forEach(c => {\n    if (c.valores?.liquido < 100) {\n      tags.push(criarTag('AVISO_VALOR_BAIXO', { competencia: c.competencia, valor: c.valores.liquido }));\n    }\n    if (c.dias <= 5) {\n      tags.push(criarTag('AVISO_PERIODO_CURTO', { competencia: c.competencia, dias: c.dias }));\n    }\n  });\n}\n\n// Parcelas juntas\nconst datasPagamento = (creditos || []).map(c => c.pagamento?.data).filter(Boolean);\nconst datasUnicas = [...new Set(datasPagamento)];\nif (datasPagamento.length > datasUnicas.length) {\n  tags.push(criarTag('INFO_PARCELAS_JUNTAS', { quantidade: datasPagamento.length - datasUnicas.length }));\n}\n\n// Se nÃ£o tem nenhum crÃ­tico, marca como OK\nconst temCritico = tags.some(t => t.nivel === 'CRITICO');\nif (!temCritico) {\n  tags.push(criarTag('OK_CALCULO_COMPLETO'));\n  if (parcelasProjetadas.length > 0 && !parcelasProjetadas.some(p => p.data_erro)) {\n    tags.push(criarTag('OK_PROJECAO_CONFIAVEL'));\n  }\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// MONTAR RESUMO E DADOS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst totalProjetado = parcelasProjetadas.reduce((sum, p) => sum + p.valor_liquido, 0);\nconst total13o = calculo13o?.valor_13o || 0;\n\nconst resumo = {\n  nome: cliente?.nome || 'Desconhecido',\n  cpf: cliente?.cpf || '',\n  nb: nb || '',\n  mr: mrValido,\n  mr_formatado: formatarMoeda(mrValido),\n  dib: formatarData(dib),\n  dcb: formatarData(dcb),\n  desconto_inss: descontoINSS.desconto,\n  desconto_inss_formatado: formatarMoeda(descontoINSS.desconto),\n  aliquota_efetiva: descontoINSS.aliquota_efetiva,\n  aliquota_efetiva_texto: `${descontoINSS.aliquota_efetiva}%`,\n  liquido_mensal: valoresDerivados.liquido_mensal,\n  liquido_mensal_formatado: formatarMoeda(valoresDerivados.liquido_mensal),\n  valor_diario_liquido: valoresDerivados.valor_diario_liquido,\n  valor_diario_liquido_formatado: formatarMoeda(valoresDerivados.valor_diario_liquido),\n  total_120_dias: valoresDerivados.total_120_dias,\n  total_120_dias_formatado: formatarMoeda(valoresDerivados.total_120_dias),\n  dias_pagos: situacaoFinanceira.dias.pagos,\n  dias_pendentes: situacaoFinanceira.dias.pendentes,\n  dias_cobertos: situacaoFinanceira.dias.cobertos,\n  dias_restantes: situacaoFinanceira.dias.restantes,\n  dias_total: 120,\n  valor_pago: situacaoFinanceira.valores.pago,\n  valor_pago_formatado: situacaoFinanceira.valores.pago_formatado,\n  valor_pendente: situacaoFinanceira.valores.pendente,\n  valor_pendente_formatado: situacaoFinanceira.valores.pendente_formatado,\n  valor_a_receber: situacaoFinanceira.valores.a_receber,\n  valor_a_receber_formatado: situacaoFinanceira.valores.a_receber_formatado,\n  valor_total_beneficio: situacaoFinanceira.valores.total_beneficio,\n  valor_total_beneficio_formatado: situacaoFinanceira.valores.total_beneficio_formatado,\n  percentual_pago: situacaoFinanceira.percentuais.pago,\n  percentual_pendente: situacaoFinanceira.percentuais.pendente,\n  percentual_coberto: situacaoFinanceira.percentuais.coberto,\n  percentual_restante: situacaoFinanceira.percentuais.restante,\n  parcelas_pagas: situacaoFinanceira.parcelas.pagas,\n  parcelas_pendentes: situacaoFinanceira.parcelas.pendentes,\n  parcelas_extrato: situacaoFinanceira.parcelas.total_extrato,\n  beneficio_completo: situacaoFinanceira.beneficio_completo,\n  tem_pendente: situacaoFinanceira.tem_pendente,\n  vai_ter_mais: situacaoFinanceira.tem_a_receber,\n  parcelas_projetadas: parcelasProjetadas.length,\n  total_projetado: tr(totalProjetado),\n  total_projetado_formatado: formatarMoeda(totalProjetado),\n  proxima_data: parcelasProjetadas[0]?.data_pagamento_prevista_formatada || '-',\n  ultima_data: parcelasProjetadas.length > 0 ? parcelasProjetadas[parcelasProjetadas.length - 1].data_pagamento_prevista_formatada : '-',\n  tem_13o: !!calculo13o,\n  valor_13o: total13o,\n  valor_13o_formatado: formatarMoeda(total13o),\n  avos_13o: calculo13o?.avos_texto || '-',\n  total_extrato: situacaoFinanceira.valores.pago + situacaoFinanceira.valores.pendente,\n  total_extrato_formatado: formatarMoeda(situacaoFinanceira.valores.pago + situacaoFinanceira.valores.pendente),\n  total_geral: tr(situacaoFinanceira.valores.pago + situacaoFinanceira.valores.pendente + totalProjetado + total13o),\n  total_geral_formatado: formatarMoeda(situacaoFinanceira.valores.pago + situacaoFinanceira.valores.pendente + totalProjetado + total13o),\n  deal_id: ctx6A.deal_id,\n  faturas_criadas: 0,\n  total_faturas: 0,\n  saldo_start: tr(valoresDerivados.total_120_dias * 0.30)\n};\n\nconst dados = {\n  tipo_documento: 'EXTRATO_CREDITOS',\n  cliente,\n  beneficio: {\n    ...beneficio,\n    desconto_inss: descontoINSS.desconto,\n    liquido_mensal: valoresDerivados.liquido_mensal,\n    valor_diario_liquido: valoresDerivados.valor_diario_liquido,\n    total_120_dias: valoresDerivados.total_120_dias\n  },\n  cobertura: {\n    ...cobertura,\n    dias_cobertos: situacaoFinanceira.dias.cobertos,\n    dias_restantes: situacaoFinanceira.dias.restantes,\n    percentual: situacaoFinanceira.percentuais.coberto,\n    vai_ter_mais_parcelas: situacaoFinanceira.tem_a_receber,\n    cobertura_completa: situacaoFinanceira.beneficio_completo\n  },\n  situacao_financeira: situacaoFinanceira,\n  calculo_inss: {\n    ano_referencia: ano,\n    faixas_utilizadas: descontoINSS.detalhes,\n    desconto_total: descontoINSS.desconto,\n    aliquota_efetiva: descontoINSS.aliquota_efetiva,\n    aliquota_efetiva_texto: `${descontoINSS.aliquota_efetiva}%`\n  },\n  creditos: creditosProcessados,\n  parcelas_projetadas: parcelasProjetadas,\n  decimo_terceiro: calculo13o,\n  calendario_info: {\n    nb: nb || '',\n    digito_calendario: extrairDigitoCalendario(nb || ''),\n    faixa_mr: mrValido <= getSalarioMinimo(ano) ? 'ATE_1SM' : 'ACIMA_1SM',\n    salario_minimo_ano: getSalarioMinimo(ano),\n    calendarios_disponiveis: ['2025', '2026']\n  },\n  deal_id: ctx6A.deal_id,\n  deal: ctx6A.deal\n};\n\n// Campos para atualizar no Deal\nconst campos_deal_enriquecido = {\n  ...campos_deal_6A,\n  [CD.aliquota_mr]: descontoINSS.aliquota_efetiva,\n  [CD.valor_total_beneficio]: valoresDerivados.total_120_dias,\n};\n\n// Campos para atualizar na Invoice\nconst campos_invoice_enriquecido = {\n  ...campos_invoice_6A,\n  [CI.aliquota_mr]: descontoINSS.aliquota_efetiva,\n  [CI.valor_liquido_mensal]: formatMoneyBitrix(valoresDerivados.liquido_mensal),\n  [CI.valor_diario]: valoresDerivados.valor_diario_liquido,\n  [CI.valor_total_beneficio]: valoresDerivados.total_120_dias,\n  [CI.dias_ja_recebidos]: situacaoFinanceira.dias.cobertos,\n  [CI.dias_restantes]: situacaoFinanceira.dias.restantes\n};\n\n// Log de debug\nconsole.log(JSON.stringify({\n  no: '6B',\n  versao: '6.5',\n  correcoes: ['MR_ORIGINAL', 'SEM_FALLBACK', 'TAGS_CRITICIDADE'],\n  ok: !temCritico,\n  pode_faturar: !temCritico,\n  mr_utilizado: mrValido,\n  tags_resumo: {\n    total: tags.length,\n    criticos: tags.filter(t => t.nivel === 'CRITICO').length,\n    avisos: tags.filter(t => t.nivel === 'AVISO').length\n  },\n  parcelas_projetadas: parcelasProjetadas.length,\n  tem_data_erro: parcelasProjetadas.some(p => p.data_erro)\n}));\n\nreturn criarRetorno(resumo, dados, tags, campos_deal_enriquecido, campos_invoice_enriquecido, ctx6A);"
  },
  "type": "n8n-nodes-base.code",
  "typeVersion": 2,
  "position": [
    5952,
    25792
  ],
  "id": "5d393afb-c040-4eff-baae-4275e4daced6",
  "name": "6B.Calculo do INSS"
}